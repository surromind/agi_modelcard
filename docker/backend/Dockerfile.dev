FROM python:3.9

WORKDIR /src

# 개발 도구 및 의존성만 미리 설치
RUN pip install pipenv

# Pipfile과 Pipfile.lock 복사
COPY modelcard-backend/Pipfile modelcard-backend/Pipfile.lock ./

# Pipfile.lock 업데이트 및 의존성 설치 (소스코드 변경과 무관)
# markdown 패키지 포함 모든 의존성 설치
RUN pipenv lock && pipenv install --dev --system

# 개발 서버 실행 (소스코드는 볼륨 마운트로 처리)
CMD ["uvicorn", "app.main:app", "--host", "0.0.0.0", "--port", "80", "--reload"]
